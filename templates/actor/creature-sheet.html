<form class="{{cssClass}} sheet flexcol" autocomplete="off">

    {{!-- Sheet Header --}}
    <header class="sheet-header sheet-header-character">
        <div class="flexrow">
            <img class="profile-img" src="{{actor.img}}" data-edit="img" title="{{actor.name}}" height="100" width="100" />
            <div class="flexcol header-fields">
                <div class="flexrow name-attribute">
                    <h1 class="charname"><input name="name" type="text" value="{{actor.name}}" placeholder="Name" /></h1>
                    <div class="header-stat-block">
                        <div class="penalties flexrow">
                            <div class="stat">UP: {{data.universalPenalty}}</div>
                            <div class="statend">PP: {{data.physicalPenalty}}</div>
                        </div>
                        <div class="endurance flexrow">
                            <span class="label">Shock Index: {{data.shockIndex.value}}</span>
                        </div>
                        <div class="endbar">
                            <span class="bar" style="width: {{data.shockIndex.value}}%"></span>
                        </div>
                    </div>
                </div>
                <div class="header-attributes">
                    <ol class="flexrow">
                        <li class="attribute creature-species flexcol">
                            <label class="label">Species</label>
                            <input class="value" type="text" name="data.species" value="{{data.species}}" data-dtype="String"/>
                        </li>
                        <li class="attribute move flexcol">
                            <label class="label">Move</label>
                            <div class="flexrow move-values">
                                <span class="move-eff">{{data.move.effective}}</span>
                                <span class="sep">/</span>
                                <input class="move-base" type="number" name="data.move.base" value="{{data.move.base}}" data-dtype="Number"/>
                            </div>
                        </li>
                    </ol>
                </div>
            </div>
        </div>
    </header>

    {{!-- Sheet Tab Navigation --}}
    <nav class="sheet-tabs tabs" data-group="primary">
        <a class="item" data-tab="facade">Fa&#231;ade</a>
        <a class="item" data-tab="profile">Profile</a>
        <a class="item" data-tab="skills">Skills</a>
        <a class="item" data-tab="combat">Combat</a>
        <a class="item" data-tab="esoteric">Esoterics</a>
        <a class="item" data-tab="inventory">Gear</a>
        <a class="item" data-tab="macro">Macro</a>
        <a class="item" data-tab="effects">Effects</a>
    </nav>

    {{!-- Sheet Body --}}
    <section class="sheet-body">

        {{!-- Facade Tab --}}
        <div class="tab facade" data-group="primary" data-tab="facade">
            <div class="flexrow">
                <img class="facade-image" src="{{data.bioImage}}" data-edit="data.bioImage" title="{{actor.name}}" height="300" width="200" />
                <div class="facade-description">
                    {{editor content=data.description target="data.description" button=true owner=owner editable=editable}}
                </div>
            </div>
        </div>

        {{!-- Profile Tab --}}
        <div class="tab profile" data-group="primary" data-tab="profile">
            <div class="flexcol">
                <ul class="flexrow ability-scores">
                    <li class="ability" data-ability="strength">
                        <h4 class="ability-name box-title rollable">Strength</h4>
                        <h3 class="ability-value">{{data.abilities.strength.effective}}</h3>
                        <div class="ability-modifiers flexrow">
                            <div class="item-dice">
                                <a class="ability-d6-roll" data-ability="strength" title="d6 Strength Roll"><i
                                        class="fas fa-dice-d6"></i></a>
                            </div>
                            <div class="ability-box">
                                <input class="ability-base" type="number" name="data.abilities.strength.base"
                                    value="{{data.abilities.strength.base}}" data-dtype="Number" />
                            </div>
                            <div class="item-dice">
                                <a class="ability-d100-roll" data-ability="strength" title="d100 Strength Roll"><i
                                        class="fas fa-dice-d20"></i></a>
                            </div>
                        </div>
                    </li>
                    <li class="ability" data-ability="stamina">
                        <h4 class="ability-name box-title rollable">Stamina</h4>
                        <h3 class="ability-value">{{data.abilities.stamina.effective}}</h3>
                        <div class="ability-modifiers flexrow">
                            <div class="item-dice">
                                <a class="ability-d6-roll" data-ability="stamina" title="d6 Stamina Roll"><i
                                        class="fas fa-dice-d6"></i></a>
                            </div>
                            <div class="ability-box">
                                <input class="ability-base" type="number" name="data.abilities.stamina.base"
                                    value="{{data.abilities.stamina.base}}" data-dtype="Number" />
                            </div>
                            <div class="item-dice">
                                <a class="ability-d100-roll" data-ability="stamina" title="d100 Stamina Roll"><i
                                        class="fas fa-dice-d20"></i></a>
                            </div>
                        </div>
                    </li>
                    <li class="ability" data-ability="dexterity">
                        <h4 class="ability-name box-title rollable">Dexterity</h4>
                        <h3 class="ability-value">{{data.abilities.dexterity.effective}}</h3>
                        <div class="ability-modifiers flexrow">
                            <div class="item-dice">
                                <a class="ability-d6-roll" data-ability="dexterity" title="d6 Dexterity Roll"><i
                                        class="fas fa-dice-d6"></i></a>
                            </div>
                            <div class="ability-box">
                                <input class="ability-base" type="number" name="data.abilities.dexterity.base"
                                    value="{{data.abilities.dexterity.base}}" data-dtype="Number" />
                            </div>
                            <div class="item-dice">
                                <a class="ability-d100-roll" data-ability="dexterity" title="d100 Dexterity Roll"><i
                                        class="fas fa-dice-d20"></i></a>
                            </div>
                        </div>
                    </li>
                    <li class="ability" data-ability="agility">
                        <h4 class="ability-name box-title rollable">Agility</h4>
                        <h3 class="ability-value">{{data.abilities.agility.effective}}</h3>
                        <div class="ability-modifiers flexrow">
                            <div class="item-dice">
                                <a class="ability-d6-roll" data-ability="agility" title="d6 Agility Roll"><i
                                        class="fas fa-dice-d6"></i></a>
                            </div>
                            <div class="ability-box">
                                <input class="ability-base" type="number" name="data.abilities.agility.base"
                                    value="{{data.abilities.agility.base}}" data-dtype="Number" />
                            </div>
                            <div class="item-dice">
                                <a class="ability-d100-roll" data-ability="agility" title="d100 Agility Roll"><i
                                        class="fas fa-dice-d20"></i></a>
                            </div>
                        </div>
                    </li>
                    <li class="ability" data-ability="intelligence">
                        <h4 class="ability-name box-title rollable">Intelligence</h4>
                        <h3 class="ability-value">{{data.abilities.intelligence.effective}}</h3>
                        <div class="ability-modifiers flexrow">
                            <div class="item-dice">
                                <a class="ability-d6-roll" data-ability="intelligence" title="d6 Intelligence Roll"><i
                                        class="fas fa-dice-d6"></i></a>
                            </div>
                            <div class="ability-box">
                                <input class="ability-base" type="number" name="data.abilities.intelligence.base"
                                    value="{{data.abilities.intelligence.base}}" data-dtype="Number" />
                            </div>
                            <div class="item-dice">
                                <a class="ability-d100-roll" data-ability="intelligence"
                                    title="d100 Intelligence Roll"><i class="fas fa-dice-d20"></i></a>
                            </div>
                        </div>
                    </li>
                    <li class="ability" data-ability="aura">
                        <h4 class="ability-name box-title rollable">Aura</h4>
                        <h3 class="ability-value">{{data.abilities.aura.effective}}</h3>
                        <div class="ability-modifiers flexrow">
                            <div class="item-dice">
                                <a class="ability-d6-roll" data-ability="aura" title="d6 Aura Roll"><i
                                        class="fas fa-dice-d6"></i></a>
                            </div>
                            <div class="ability-box">
                                <input class="ability-base" type="number" name="data.abilities.aura.base"
                                    value="{{data.abilities.aura.base}}" data-dtype="Number" />
                            </div>
                            <div class="item-dice">
                                <a class="ability-d100-roll" data-ability="aura" title="d100 Aura Roll"><i
                                        class="fas fa-dice-d20"></i></a>
                            </div>
                        </div>
                    </li>
                    <li class="ability" data-ability="will">
                        <h4 class="ability-name box-title rollable">Will</h4>
                        <h3 class="ability-value">{{data.abilities.will.effective}}</h3>
                        <div class="ability-modifiers flexrow">
                            <div class="item-dice">
                                <a class="ability-d6-roll" data-ability="will" title="d6 Will Roll"><i
                                        class="fas fa-dice-d6"></i></a>
                            </div>
                            <div class="ability-box">
                                <input class="ability-base" type="number" name="data.abilities.will.base"
                                    value="{{data.abilities.will.base}}" data-dtype="Number" />
                            </div>
                            <div class="item-dice">
                                <a class="ability-d100-roll" data-ability="will" title="d100 Will Roll"><i
                                        class="fas fa-dice-d20"></i></a>
                            </div>
                        </div>
                    </li>
                </ul>
                <ul class="flexrow ability-scores">
                    <li class="ability" data-ability="eyesight">
                        <h4 class="ability-name box-title rollable">Eyesight</h4>
                        <h3 class="ability-value">{{data.abilities.eyesight.effective}}</h3>
                        <div class="ability-modifiers flexrow">
                            <div class="item-dice">
                                <a class="ability-d6-roll" data-ability="eyesight" title="d6 Eyesight Roll"><i
                                        class="fas fa-dice-d6"></i></a>
                            </div>
                            <div class="ability-box">
                                <input class="ability-base" type="number" name="data.abilities.eyesight.base"
                                    value="{{data.abilities.eyesight.base}}" data-dtype="Number" />
                            </div>
                            <div class="item-dice">
                                <a class="ability-d100-roll" data-ability="eyesight" title="d100 Eyesight Roll"><i
                                        class="fas fa-dice-d20"></i></a>
                            </div>
                        </div>
                    </li>
                    <li class="ability" data-ability="hearing">
                        <h4 class="ability-name box-title rollable">Hearing</h4>
                        <h3 class="ability-value">{{data.abilities.hearing.effective}}</h3>
                        <div class="ability-modifiers flexrow">
                            <div class="item-dice">
                                <a class="ability-d6-roll" data-ability="hearing" title="d6 Hearing Roll"><i
                                        class="fas fa-dice-d6"></i></a>
                            </div>
                            <div class="ability-box">
                                <input class="ability-base" type="number" name="data.abilities.hearing.base"
                                    value="{{data.abilities.hearing.base}}" data-dtype="Number" />
                            </div>
                            <div class="item-dice">
                                <a class="ability-d100-roll" data-ability="hearing" title="d100 Hearing Roll"><i
                                        class="fas fa-dice-d20"></i></a>
                            </div>
                        </div>
                    </li>
                    <li class="ability" data-ability="smell">
                        <h4 class="ability-name box-title rollable">Smell</h4>
                        <h3 class="ability-value">{{data.abilities.smell.effective}}</h3>
                        <div class="ability-modifiers flexrow">
                            <div class="item-dice">
                                <a class="ability-d6-roll" data-ability="smell" title="d6 Smell Roll"><i
                                        class="fas fa-dice-d6"></i></a>
                            </div>
                            <div class="ability-box">
                                <input class="ability-base" type="number" name="data.abilities.smell.base"
                                    value="{{data.abilities.smell.base}}" data-dtype="Number" />
                            </div>
                            <div class="item-dice">
                                <a class="ability-d100-roll" data-ability="smell" title="d100 Smell Roll"><i
                                        class="fas fa-dice-d20"></i></a>
                            </div>
                        </div>
                    </li>
                    <li class="ability" data-ability="voice">
                        <h4 class="ability-name box-title rollable">Voice</h4>
                        <h3 class="ability-value">{{data.abilities.voice.effective}}</h3>
                        <div class="ability-modifiers flexrow">
                            <div class="item-dice">
                                <a class="ability-d6-roll" data-ability="voice" title="d6 Voice Roll"><i
                                        class="fas fa-dice-d6"></i></a>
                            </div>
                            <div class="ability-box">
                                <input class="ability-base" type="number" name="data.abilities.voice.base"
                                    value="{{data.abilities.voice.base}}" data-dtype="Number" />
                            </div>
                            <div class="item-dice">
                                <a class="ability-d100-roll" data-ability="voice" title="d100 Voice Roll"><i
                                        class="fas fa-dice-d20"></i></a>
                            </div>
                        </div>
                    </li>
                </ul>
                <div class="profile-params">
                    <div class="flexrow profile-item">
                        <div class="attribute species flexrow">
                            <label class="label">Load Rating</label>
                            <input class="value" type="text" name="data.loadRating" value="{{data.loadRating}}"
                                data-dtype="Number" />
                        </div>
                    </div>
                </div>
                <div class="flexrow items traits">
                    <ol class="items-list traits-list">
                        <li class="items-header trait flexrow">
                            <h3 class="item-name trait-name">Physical Traits<a class="more-info"
                                data-journal-entry="Sheet - Profile Tab"><i
                                    class="far fa-question-circle"></i></a></h3>
                            <div class="trait-notes item-detail">Notes</div>
                            <div class="item-controls">
                                <a class="item-control item-create active" title="Create Physical Trait"
                                    data-type="trait" data-traittype="Physical"><i class="fas fa-plus"></i> Add</a>
                            </div>
                        </li>
                        <ol class="item-list trait-list">
                            {{#each items as |item id|}}
                                {{#if (and (eq item.type "trait") (eq item.data.type "Physical"))}}
                                    <li class="item trait trait-item flexrow" data-item-id="{{item._id}}"
                                        data-item-name="{{item.name}}">
                                        <div class="item-name trait-name flexrow">
                                            <div class="item-image" style="background-image: url('{{item.img}}')"></div>
                                            <h4>{{item.name}}</h4>
                                        </div>
                                        <div class="trait-notes">{{data.notes}}</div>
                                        <div class="item-controls">
                                            <a class="item-control item-edit" title="Edit Trait"><i
                                                    class="active fas fa-edit"></i></a>
                                            <a class="item-control item-delete" title="Delete Trait"
                                                data-label="Physical Trait"><i class="active fas fa-trash"></i></a>
                                        </div>
                                    </li>
                                {{/if}}
                            {{/each}}
                        </ol>        
                    </ol>
                    <ol class="items-list traits-list">
                        <li class="items-header trait flexrow">
                            <h3 class="item-name trait-name">Psyche Traits<a class="more-info"
                                data-journal-entry="Sheet - Profile Tab"><i
                                    class="far fa-question-circle"></i></a></h3>
                            <div class="trait-notes item-detail">Notes</div>
                            <div class="item-controls">
                                <a class="item-control item-create active" title="Create Psyche Trait" data-type="trait"
                                    data-traittype="Psyche"><i class="fas fa-plus"></i> Add</a>
                            </div>
                        </li>
                        <ol class="item-list trait-list">
                            {{#each items as |item id|}}
                                {{#if (and (eq item.type "trait") (eq item.data.type "Psyche"))}}
                                    <li class="item trait trait-item flexrow" data-item-id="{{item._id}}"
                                        data-item-name="{{item.name}}">
                                        <div class="item-name trait-name flexrow">
                                            <div class="item-image" style="background-image: url('{{item.img}}')"></div>
                                            <h4>{{item.name}}</h4>
                                        </div>
                                        <div class="trait-notes">{{data.notes}}</div>
                                        <div class="item-controls">
                                            <a class="item-control item-edit" title="Edit Trait"><i
                                                    class="active fas fa-edit"></i></a>
                                            <a class="item-control item-delete" title="Delete Trait"
                                                data-label="Psyche Trait"><i class="active fas fa-trash"></i></a>
                                        </div>
                                    </li>
                                {{/if}}
                            {{/each}}
                        </ol>        
                    </ol>
                </div>
                <div class="flexcol">
                    <div class="profile-desc flexcol">
                        <label class="label">Description<a class="more-info"
                            data-journal-entry="Sheet - Profile Tab"><i
                                class="far fa-question-circle"></i></a></label>
                        <div class="description">
                            {{editor content=data.biography target="data.biography" button=true owner=owner editable=editable}}
                        </div>
                    </div>
                </div>
            </div>
        </div>

        {{!-- Skills Tab --}}
        <div class="tab skills items" data-group="primary" data-tab="skills">
            <div class="flexrow">
                <input class="skill-name-filter" type="text" name="data.skillNameFilter" placeholder="Filter skills by name..." data-dtype="String" />
            </div>

            <!-- Physical Skills -->
            <ol class="items-list skills-list">
                <li class="items-header skill flexrow">
                    <h3 class="item-name skill-name">Physical Skills<a class="more-info"
                        data-journal-entry="Sheet - Skills Tab"><i
                            class="far fa-question-circle"></i></a></h3>
                    <div class="skill-ele item-detail">SB</div>
                    <div class="skill-ele item-detail">ML</div>
                    <div class="skill-ele item-detail">EML</div>
                    <div class="skill-notes item-detail">Notes</div>
                    <div class="item-controls">
                        <a class="item-control item-create" title="Create Physical Skill" data-type="skill" data-skilltype="Physical"><i
                                class="fas fa-plus"></i> Add</a>
                    </div>
                </li>
                <ol class="item-list skill-list">
                    {{#each items as |item id|}}
                        {{#if (and (eq item.type "skill") (eq item.data.type "Physical"))}}
                            <li class="item skill flexrow" data-item-id="{{item._id}}" data-item-name="{{data.name}}">
                                <div class="item-name skill-roll skill-name flexrow">
                                    <div class="item-image" style="background-image: url('{{item.img}}')"></div>
                                    <h4>{{item.name}}</h4>
                                </div>
                                <div class="skill-ele item-detail">{{data.skillBase.value}}</div>
                                <div class="skill-ele item-detail">{{data.masteryLevel}}</div>
                                <div class="skill-ele item-detail">{{data.effectiveMasteryLevel}}</div>
                                <div class="skill-notes">{{data.notes}}</div>
                                <div class="item-controls">
                                    <a class="item-control item-edit" title="Edit Skill"><i class="fas fa-edit"></i></a>
                                    <a class="item-control item-delete" title="Delete Skill" data-label="Physical Skill"><i class="fas fa-trash"></i></a>
                                </div>
                            </li>
                        {{/if}}
                    {{/each}}
                </ol>
            </ol>

            <!-- Communication Skills -->
            <ol class="items-list skills-list">
                <li class="items-header skill flexrow">
                    <h3 class="item-name skill-name">Communication Skills<a class="more-info"
                        data-journal-entry="Sheet - Skills Tab"><i
                            class="far fa-question-circle"></i></a></h3>
                    <div class="skill-ele item-detail">SB</div>
                    <div class="skill-ele item-detail">ML</div>
                    <div class="skill-ele item-detail">EML</div>
                    <div class="skill-notes item-detail">Notes</div>
                    <div class="item-controls">
                        <a class="item-control item-create" title="Create Communication Skill" data-type="skill" data-skilltype="Communication"><i
                                class="fas fa-plus"></i> Add</a>
                    </div>
                </li>
                <ol class="item-list skill-list">
                    {{#each items as |item id|}}
                        {{#if (and (eq item.type "skill") (eq item.data.type "Communication"))}}
                            <li class="item skill flexrow" data-item-id="{{item._id}}" data-item-name="{{data.name}}">
                                <div class="item-name skill-roll skill-name flexrow">
                                    <div class="item-image" style="background-image: url('{{item.img}}')"></div>
                                    <h4>{{item.name}}</h4>
                                </div>
                                <div class="skill-ele item-detail">{{data.skillBase.value}}</div>
                                <div class="skill-ele item-detail">{{data.masteryLevel}}</div>
                                <div class="skill-ele item-detail">{{data.effectiveMasteryLevel}}</div>
                                <div class="skill-notes">{{data.notes}}</div>
                                <div class="item-controls">
                                    <a class="item-control item-edit" title="Edit Skill"><i class="fas fa-edit"></i></a>
                                    <a class="item-control item-delete" title="Delete Skill" data-label="Communication Skill"><i class="fas fa-trash"></i></a>
                                </div>
                            </li>
                        {{/if}}
                    {{/each}}
                </ol>
            </ol>

            <!-- Combat Skills -->
            <ol class="items-list skills-list">
                <li class="items-header skill flexrow">
                    <h3 class="item-name skill-name">Combat Skills<a class="more-info"
                        data-journal-entry="Sheet - Skills Tab"><i
                            class="far fa-question-circle"></i></a></h3>
                    <div class="skill-ele item-detail">SB</div>
                    <div class="skill-ele item-detail">ML</div>
                    <div class="skill-ele item-detail">EML</div>
                    <div class="skill-notes item-detail">Notes</div>
                    <div class="item-controls">
                        <a class="item-control item-create" title="Create Combat Skill" data-type="skill" data-skilltype="Combat"><i
                                class="fas fa-plus"></i> Add</a>
                    </div>
                </li>
                <ol class="item-list skill-list">
                    {{#each items as |item id|}}
                        {{#if (and (eq item.type "skill") (eq item.data.type "Combat"))}}
                            <li class="item skill flexrow" data-item-id="{{item._id}}" data-item-name="{{data.name}}">
                                <div class="item-name skill-roll skill-name flexrow">
                                    <div class="item-image" style="background-image: url('{{item.img}}')"></div>
                                    <h4>{{item.name}}</h4>
                                </div>
                                <div class="skill-ele item-detail">{{data.skillBase.value}}</div>
                                <div class="skill-ele item-detail">{{data.masteryLevel}}</div>
                                <div class="skill-ele item-detail">{{data.effectiveMasteryLevel}}</div>
                                <div class="skill-notes">{{data.notes}}</div>
                                <div class="item-controls">
                                    <a class="item-control item-edit" title="Edit Skill"><i class="fas fa-edit"></i></a>
                                    <a class="item-control item-delete" title="Delete Skill" data-label="Combat Skill"><i class="fas fa-trash"></i></a>
                                </div>
                            </li>
                        {{/if}}
                    {{/each}}
                </ol>
            </ol>

            <!-- Craft Skills -->
            <ol class="items-list skills-list">
                <li class="items-header skill flexrow">
                    <h3 class="item-name skill-name">Craft Skills<a class="more-info"
                        data-journal-entry="Sheet - Skills Tab"><i
                            class="far fa-question-circle"></i></a></h3>
                    <div class="skill-ele item-detail">SB</div>
                    <div class="skill-ele item-detail">ML</div>
                    <div class="skill-ele item-detail">EML</div>
                    <div class="skill-notes item-detail">Notes</div>
                    <div class="item-controls">
                        <a class="item-control item-create" title="Create Craft Skill" data-type="skill" data-skilltype="Craft"><i
                                class="fas fa-plus"></i> Add</a>
                    </div>
                </li>
                <ol class="item-list skill-list">
                    {{#each items as |item id|}}
                        {{#if (and (eq item.type "skill") (eq item.data.type "Craft"))}}
                            <li class="item skill flexrow" data-item-id="{{item._id}}" data-item-name="{{data.name}}">
                                <div class="item-name skill-roll skill-name flexrow">
                                    <div class="item-image" style="background-image: url('{{item.img}}')"></div>
                                    <h4>{{item.name}}</h4>
                                </div>
                                <div class="skill-ele item-detail">{{data.skillBase.value}}</div>
                                <div class="skill-ele item-detail">{{data.masteryLevel}}</div>
                                <div class="skill-ele item-detail">{{data.effectiveMasteryLevel}}</div>
                                <div class="skill-notes">{{data.notes}}</div>
                                <div class="item-controls">
                                    <a class="item-control item-edit" title="Edit Skill"><i class="fas fa-edit"></i></a>
                                    <a class="item-control item-delete" title="Delete Skill" data-label="Craft Skill"><i class="fas fa-trash"></i></a>
                                </div>
                            </li>
                        {{/if}}
                    {{/each}}
                </ol>
            </ol>
        </div>

        {{!-- Combat Tab --}}
        <div class="tab combat items" data-group="primary" data-tab="combat">
            <div class="items-list">
                <div class="items-header flexrow">
                    <h3 class="item-name">Combat Statistics<a class="more-info"
                        data-journal-entry="Sheet - Combat Tab"><i
                            class="far fa-question-circle"></i></a></h3>
                </div>
            </div>
            <div class="items-list combat-stats grid grid-fixed-row grid-5col">
                <div class="combat-stat flexrow">
                    <div class="item-dice"></div>
                    <label for="data.fatigue" class="combat-stat-label">Fatigue</label>
                    <div class="combat-eff-fatigue">{{data.eph.fatigue}} / </div>
                    <input class="combat-fatigue-input" type="text" name="data.fatigue" value="{{data.fatigue}}"
                        data-dtype="Number" />
                </div>
                <div class="combat-stat flexrow">
                    <div class="item-dice"></div>
                    <label class="combat-stat-label">Init.</label>
                    <div class="combat-stat-value">{{data.initiative}}</div>
                </div>
                <div class="combat-stat flexrow">
                    <div class="item-dice">
                        <i class="active fas fa-dice-d20"></i>
                    </div>
                    <label class="combat-stat-label"><a class="dodge-roll" title="Dodge Roll">Dodge</a></label>
                    <div class="combat-stat-value">{{data.dodge}}</div>
                </div>
                <div class="combat-stat flexrow">
                    <div class="item-dice"></div>
                    <label class="combat-stat-label">Encumb.</label>
                    <div class="combat-stat-value">{{data.encumbrance}}</div>
                </div>
                <div class="combat-stat flexrow">
                    <div class="item-dice"></div>
                    <label class="combat-stat-label">Endur.</label>
                    <div class="combat-stat-value">{{data.endurance}}</div>                    
                </div>
            </div>
            <div class="combat-stat flexrow"></div>
            <div class="items-list combat-stats grid grid-fixed-row grid-5col">
                <div class="combat-stat flexrow">
                    <div class="item-dice">
                        <i class="active fas fa-dice-d20"></i>
                    </div>
                    <label class="combat-stat-label tooltip"><a class="injury-roll" title="Injury Roll">Injury</a><span class="tooltiptext">Calculate my hit location and injury level</span></label>
                </div>
                <div class="combat-stat flexrow">
                    <div class="item-dice">
                        <i class="active fas fa-dice-d20"></i>
                    </div>
                    <label class="combat-stat-label"><a class="shock-roll" title="Shock Roll">Shock</a></label>
                </div>
                <div class="combat-stat flexrow">
                    <div class="item-dice">
                        <i class="active fas fa-dice-d20"></i>
                    </div>
                    <label class="combat-stat-label"><a class="stumble-roll" title="Stumble Roll">Stumble</a></label>
                </div>
                <div class="combat-stat flexrow">
                    <div class="item-dice">
                        <i class="active fas fa-dice-d20"></i>
                    </div>
                    <label class="combat-stat-label"><a class="fumble-roll" title="Fumble Roll">Fumble</a></label>
                </div>
                <div class="combat-stat flexrow">
                    <div class="item-dice">
                        <i class="active fas fa-dice-d20"></i>
                    </div>
                    <label class="combat-stat-label tooltip"><a class="damage-roll" title="Damage Roll">Damage</a><span class="tooltiptext">Roll damage not associated with any specific weapon</span></label>
                </div>
            </div>

            <!-- Weapons -->
            <ol class="items-list weapons-list">
                <li class="items-header weapon flexrow">
                    <h3 class="item-name weapon-name">Melee Weapons<a class="more-info"
                        data-journal-entry="Sheet - Combat Tab"><i
                            class="far fa-question-circle"></i></a></h3>
                    <div class="item-detail weapon-qty">Qty</div>
                    <div class="item-detail weapon-quality">WQ</div>
                    <div class="item-detail weapon-atkdef">A/D</div>
                    <div class="item-detail weapon-atkmod">Mod</div>
                    <div class="item-detail weapon-blunt">B</div>
                    <div class="item-detail weapon-edged">E</div>
                    <div class="item-detail weapon-piercing">P</div>
                    <div class="item-detail weapon-attack">AML</div>
                    <div class="item-detail weapon-defense">DML</div>
                    <div class="item-detail weapon-notes">Notes</div>
                </li>
                <ol class="item-list weapon-list">
                    {{#each items as |item id|}}
                        {{#if (and (eq item.type "weapongear") data.isEquipped)}}
                            <li class="item weapon {{#unless data.isCarried}}nocarry{{/unless}} flexrow" data-item-id="{{item._id}}" data-item-name="{{data.name}}">
                                <div class="item-name weapon-name {{#if (and data.isEquipped data.isCarried)}}melee-weapon-attack{{/if}} flexrow">
                                    <div class="item-image" style="background-image: url('{{item.img}}')"></div>
                                    <h4>{{item.name}}</h4>
                                </div>
                                <div class="item-detail weapon-qty">{{data.quantity}}</div>
                                <div class="item-detail weapon-quality">{{data.weaponQuality}}</div>
                                <div class="item-detail weapon-atkdef">{{data.attack}}/{{data.defense}}</div>
                                <div class="item-detail weapon-atkmod">{{data.attackModifier}}</div>
                                {{#if (lt data.blunt 0)}}
                                <div class="item-detail weapon-blunt"><i class="fas fa-times"></i></div>
                                {{else}}
                                <div class="item-detail weapon-blunt {{#if (and data.isEquipped data.isCarried)}}active{{/if}}">{{#if (and data.isEquipped data.isCarried)}}<a class="weapon-damage-roll" title="{{item.name}} Blunt Damage Roll" data-weapon="{{item.name}}" data-aspect="Blunt">{{data.blunt}}</a>{{else}}{{data.blunt}}{{/if}}</div>
                                {{/if}}
                                {{#if (lt data.edged 0)}}
                                <div class="item-detail weapon-edged"><i class="fas fa-times"></i></div>
                                {{else}}
                                <div class="item-detail weapon-edged {{#if (and data.isEquipped data.isCarried)}}active{{/if}}">{{#if (and data.isEquipped data.isCarried)}}<a class="weapon-damage-roll" title="{{item.name}} Edged Damage Roll" data-weapon="{{item.name}}" data-aspect="Edged">{{data.edged}}</a>{{else}}{{data.edged}}{{/if}}</div>
                                {{/if}}
                                {{#if (lt data.piercing 0)}}
                                <div class="item-detail weapon-piercing"><i class="fas fa-times"></i></div>
                                {{else}}
                                <div class="item-detail weapon-piercing {{#if (and data.isEquipped data.isCarried)}}active{{/if}}">{{#if (and data.isEquipped data.isCarried)}}<a class="weapon-damage-roll" title="{{item.name}} Piercing Damage Roll" data-weapon="{{item.name}}" data-aspect="Piercing">{{data.piercing}}</a>{{else}}{{data.piercing}}{{/if}}</div>
                                {{/if}}
                                <div class="item-detail weapon-attack {{#if (and data.isEquipped data.isCarried)}}active{{/if}}">{{#if (and data.isEquipped data.isCarried)}}<a class="weapon-attack-roll" title="{{item.name}} Attack Roll">{{data.attackMasteryLevel}}</a>{{else}}{{data.attackMasteryLevel}}{{/if}}</div>
                                <div class="item-detail weapon-defense {{#if (and data.isEquipped data.isCarried)}}active{{/if}}">{{#if (and data.isEquipped data.isCarried)}}<a class="weapon-defend-roll" title="{{item.name}} Defense Roll">{{data.defenseMasteryLevel}}</a>{{else}}{{data.defenseMasteryLevel}}{{/if}}</div>
                                <div class="item-detail weapon-notes">{{data.notes}}</div>
                            </li>
                        {{/if}}
                    {{/each}}
                </ol>
            </ol>

            <!-- Missiles -->
            <ol class="items-list missiles-list">
                <li class="items-header missile flexrow">
                    <h3 class="item-name missile-name">Missile Weapons<a class="more-info"
                        data-journal-entry="Sheet - Combat Tab"><i
                            class="far fa-question-circle"></i></a></h3>
                    <div class="item-detail missile-qty">Qty</div>
                    <div class="item-detail missile-skill">Skill</div>
                    <div class="item-detail missile-short">Short</div>
                    <div class="item-detail missile-medium">Med</div>
                    <div class="item-detail missile-long">Long</div>
                    <div class="item-detail missile-extreme">Ext</div>
                    <div class="item-detail missile-attack">AML</div>
                    <div class="item-detail missile-notes">Notes</div>
                </li>
                <ol class="item-list missile-list">
                    {{#each items as |item id|}}
                        {{#if (and (eq item.type "missilegear") data.isEquipped)}}
                            <li class="item missile {{#unless data.isCarried}}nocarry{{/unless}} flexrow" data-item-id="{{item._id}}" data-item-name="{{data.name}}">
                                <div class="item-name missile-name {{#if (and data.isEquipped data.isCarried)}}missile-weapon-attack{{/if}} flexrow">
                                    <div class="item-image" style="background-image: url('{{item.img}}')"></div>
                                    <h4>{{item.name}}</h4>
                                </div>
                                <div class="item-detail missile-qty">{{data.quantity}}</div>
                                <div class="item-detail missile-skill">{{data.assocSkill}}</div>
                                {{#if (lt data.range.short 0)}}
                                <div class="item-detail missile-short"><i class="fas fa-times"></i></div>
                                {{else}}
                                <div class="item-detail missile-short {{#if (and data.isEquipped data.isCarried)}}active{{/if}}">{{#if (and data.isEquipped data.isCarried)}}<a class="missile-damage-roll" title="{{item.name}} Short-Range Damage Roll" data-weapon="{{item.name}}" data-range="Short">{{data.range.short}}/{{data.impact.short}}</a>{{else}}{{data.range.short}}/{{data.impact.short}}{{/if}}</div>
                                {{/if}}
                                {{#if (lt data.range.medium 0)}}
                                <div class="item-detail missile-medium"><i class="fas fa-times"></i></div>
                                {{else}}
                                <div class="item-detail missile-medium {{#if (and data.isEquipped data.isCarried)}}active{{/if}}">{{#if (and data.isEquipped data.isCarried)}}<a class="missile-damage-roll" title="{{item.name}} Medium-Range Damage Roll" data-weapon="{{item.name}}" data-range="Medium">{{data.range.medium}}/{{data.impact.medium}}</a>{{else}}{{data.range.medium}}/{{data.impact.medium}}{{/if}}</div>
                                {{/if}}
                                {{#if (lt data.range.long 0)}}
                                <div class="item-detail missile-long"><i class="fas fa-times"></i></div>
                                {{else}}
                                <div class="item-detail missile-long {{#if (and data.isEquipped data.isCarried)}}active{{/if}}">{{#if (and data.isEquipped data.isCarried)}}<a class="missile-damage-roll" title="{{item.name}} Long-Range Damage Roll" data-weapon="{{item.name}}" data-range="Long">{{data.range.long}}/{{data.impact.long}}</a>{{else}}{{data.range.long}}/{{data.impact.long}}{{/if}}</div>
                                {{/if}}
                                {{#if (lt data.range.extreme 0)}}
                                <div class="item-detail missile-extreme"><i class="fas fa-times"></i></div>
                                {{else}}
                                <div class="item-detail missile-extreme {{#if (and data.isEquipped data.isCarried)}}active{{/if}}">{{#if (and data.isEquipped data.isCarried)}}<a class="missile-damage-roll" title="{{item.name}} Extreme-Range Damage Roll" data-weapon="{{item.name}}" data-range="Extreme">{{data.range.extreme}}/{{data.impact.extreme}}</a>{{else}}{{data.range.extreme}}/{{data.impact.extreme}}{{/if}}</div>
                                {{/if}}
                                <div class="item-detail missile-attack {{#if (and data.isEquipped data.isCarried)}}active{{/if}}">{{#if (and data.isEquipped data.isCarried)}}<a class="missile-attack-roll" title="Missile Attack Roll">{{data.attackMasteryLevel}}</a>{{else}}{{data.attackMasteryLevel}}{{/if}}</div>
                                <div class="item-detail missile-notes">{{data.notes}}</div>
                            </li>
                        {{/if}}
                    {{/each}}
                </ol>
            </ol>

            <!-- Injuries -->
            <ol class="items-list injuries-list">
                <li class="items-header injury flexrow">
                    <h3 class="item-name injury-name">Injuries<a class="more-info"
                        data-journal-entry="Sheet - Combat Tab"><i
                            class="far fa-question-circle"></i></a></h3>
                    <div class="item-detail injury-healrate">HR</div>
                    <div class="item-detail injury-severity">IL</div>
                    <div class="item-detail injury-notes">Notes</div>
                    <div class="item-controls">
                        <a class="item-control item-create active" title="Create Injury" data-type="injury"><i
                                class="fas fa-plus"></i> Add</a>
                    </div>
                </li>
                <ol class="item-list injury-list">
                    {{#each items as |item id|}}
                        {{#if (eq item.type "injury")}}
                            <li class="item injury flexrow" data-item-id="{{item._id}}" data-item-name="{{data.name}}">
                                <div class="item-name injury-name flexrow">
                                    <h4>{{item.name}}</h4>
                                </div>
                                <div class="item-detail injury-healrate active"><a class="healing-roll" title="{{item.name}} Healing Roll">{{data.healRate}}</a></div>
                                <div class="item-detail injury-severity">{{data.severity}}</div>
                                <div class="item-detail injury-notes">{{data.notes}}</div>
                                <div class="item-controls">
                                    <a class="item-control item-edit" title="Edit Injury"><i class="active fas fa-edit"></i></a>
                                    <a class="item-control item-delete" title="Delete Injury" data-label="Injury"><i class="active fas fa-trash"></i></a>
                                </div>
                            </li>
                        {{/if}}
                    {{/each}}
                </ol>
            </ol>

            <!-- Locations -->
            <ol class="items-list armorlocations-list">
                <li class="items-header armorlocation flexrow">
                    <h3 class="item-name armorlocation-name">Armor Locations<a class="more-info"
                        data-journal-entry="Sheet - Combat Tab"><i
                            class="far fa-question-circle"></i></a></h3>
                    <div class="item-detail armorlocation-layers">Layers</div>
                    <div class="item-detail armorlocation-quality">AQ</div>
                    <div class="item-detail armorlocation-blunt">B</div>
                    <div class="item-detail armorlocation-edged">E</div>
                    <div class="item-detail armorlocation-piercing">P</div>
                    <div class="item-detail armorlocation-fire">F</div>
                    <div class="item-detail armorlocation-notes">Notes</div>
                    <div class="item-controls">
                        <a class="item-control item-create active" title="Create Location" data-type="armorlocation"><i
                                class="fas fa-plus"></i> Add</a>
                    </div>
                </li>
                <ol class="item-list armorlocation-list">
                    {{#each items as |item id|}}
                        {{#if (eq item.type "armorlocation")}}
                            <li class="item armorlocation flexrow" data-item-id="{{item._id}}" data-item-name="{{data.name}}">
                                <div class="item-name armorlocation-name flexrow">
                                    <h4>{{item.name}}</h4>
                                </div>
                                <div class="item-detail armorlocation-layers">{{data.layers}}</div>
                                <div class="item-detail armorlocation-quality">{{data.armorQuality}}</div>
                                <div class="item-detail armorlocation-blunt">{{data.blunt}}</div>
                                <div class="item-detail armorlocation-edged">{{data.edged}}</div>
                                <div class="item-detail armorlocation-piercing">{{data.piercing}}</div>
                                <div class="item-detail armorlocation-fire">{{data.fire}}</div>
                                <div class="item-detail armorlocation-notes">{{data.notes}}</div>
                                <div class="item-controls">
                                    <a class="item-control item-edit" title="Edit Location"><i class="active fas fa-edit"></i></a>
                                    <a class="item-control item-delete" title="Delete Location" data-label="Location"><i class="active fas fa-trash"></i></a>
                                </div>
                            </li>
                        {{/if}}
                    {{/each}}
                </ol>
            </ol>
        </div>

        {{!-- Magic/Religion Tab --}}
        <div class="tab esoteric items" data-group="primary" data-tab="esoteric">
            <!-- Psionic Talents -->
            <ol class="items-list psionics-list">
                <li class="items-header psionic flexrow">
                    <h3 class="item-name psionic-name">Psionic Talents<a class="more-info"
                        data-journal-entry="Sheet - Esoterics Tab"><i
                            class="far fa-question-circle"></i></a></h3>
                    <div class="item-detail psionic-fatigue">Fatigue</div>
                    <div class="item-detail psionic-sb">SB</div>
                    <div class="item-detail psionic-ml">ML</div>
                    <div class="item-detail psionic-eml">EML</div>
                    <div class="item-detail psionic-notes">Notes</div>
                    <div class="item-controls">
                        <a class="item-control item-create active" title="Create Psionic Talent" data-type="psionic"><i
                                class="fas fa-plus"></i> Add</a>
                    </div>
                </li>
                <ol class="item-list spell-list">
                    {{#each items as |item id|}}
                    {{#if (eq item.type "psionic")}}
                            <li class="item psionic flexrow" data-item-id="{{item._id}}" data-item-name="{{data.name}}">
                                <div class="item-name psionic-name psionic-roll flexrow">
                                    <div class="item-image" style="background-image: url('{{item.img}}')"></div>
                                    <h4>{{item.name}}</h4>
                                </div>
                                <div class="item-detail psionic-fatigue">{{data.fatigue}}</div>
                                <div class="item-detail psionic-sb">{{data.skillBase.value}}</div>
                                <div class="item-detail psionic-ml">{{data.masteryLevel}}</div>
                                <div class="item-detail psionic-eml">{{data.effectiveMasteryLevel}}</div>
                                <div class="item-detail psionic-notes">{{data.notes}}</div>
                                <div class="item-controls">
                                    <a class="item-control item-edit" title="Edit Psionic Talent"><i class="active fas fa-edit"></i></a>
                                    <a class="item-control item-delete" title="Delete Psionic Talent" data-label="Psionic Talent"><i class="active fas fa-trash"></i></a>
                                </div>
                            </li>
                        {{/if}}
                    {{/each}}
                </ol>
            </ol>
        </div>

        {{!-- Inventory Tab --}}
        <div class="tab inventory items" data-group="primary" data-tab="inventory">
            <div class="flexrow">
                <ol class="weight flexcol">
                    <li class="weight-header flexrow">
                        <div class="weight-detail title"></div>
                        <div class="weight-detail weapon">Weapon</div>
                        <div class="weight-detail missile">Missile</div>
                        <div class="weight-detail armor">Armor</div>
                        <div class="weight-detail misc-gear">Misc. Gear</div>
                        <div class="total">Total</div>
                    </li>
                    <li class="weight-line flexrow">
                        <div class="weight-detail title">Weight</div>
                        <div class="weight-detail weapon">{{data.eph.totalWeaponWeight}}</div>
                        <div class="weight-detail missile">{{data.eph.totalMissileWeight}}</div>
                        <div class="weight-detail armor">{{data.eph.totalArmorWeight}}</div>
                        <div class="weight-detail misc-gear">{{data.eph.totalMiscGearWeight}}</div>
                        <div class="total">{{data.eph.totalGearWeight}}</div>
                    </li>
                </ol>
                <div class="buf"></div>
            </div>

            <!-- Gear -->
            <div class="flexrow">
                <input class="gear-name-filter" type="text" name="data.gearNameFilter"
                    placeholder="Filter gear by name..." data-dtype="String" />
            </div>
            {{#each containers as |citem cid|}}
                <ol class="items-list gear-list">
                    <li class="items-header gear flexrow" data-container-id="{{cid}}"
                        data-container-name="{{citem.data.name}}">
                        <h3 class="item-name gear-name">{{citem.data.name}}<a class="more-info"
                            data-journal-entry="Sheet - Gear Tab"><i
                                class="far fa-question-circle"></i></a></h3>
                        <div class="item-detail gear-type">Type</div>
                        <div class="item-detail gear-qty">Qty</div>
                        <div class="item-detail gear-weight">Weight</div>
                        <div class="item-detail gear-notes">Notes</div>
                        <div
                            class="item detail gear-capacity {{#if (gt citem.data.data.capacity.value citem.data.data.capacity.max)}}overcapacity{{/if}}">
                            Capacity: {{citem.data.data.capacity.value}}/{{citem.data.data.capacity.max}}</div>
                        <div class="item-controls">
                            <a class="item-control item-create active" title="Add Gear" data-type="gear"
                                data-container-id="{{cid}}" data-container-name="{{citem.data.name}}"><i
                                    class="fas fa-plus"></i> Add</a>
                        </div>
                    </li>
                    <ol class="item-list gear-list">
                        {{#each ../items as | item |}}
                            {{#if (and (endswith item.type "gear") (eq item.data.container cid))}}
                                <li class="item gear-item {{#unless data.isCarried}}nocarry{{/unless}} flexrow"
                                    data-item-id="{{item._id}}" data-item-name="{{item.name}}"
                                    data-container-id="{{cid}}" data-container-name="{{citem.data.name}}">
                                    <div class="item-name gear-name flexrow">
                                        <div class="item-image" style="background-image: url('{{item.img}}')"></div>
                                        <h4>{{item.name}}</h4>
                                    </div>
                                    <div class="item-detail gear-type">{{lookup ../../gearTypes item.type}}</div>
                                    <div class="item-detail gear-qty">{{data.quantity}}</div>
                                    <div class="item-detail gear-weight">{{data.weight}}</div>
                                    <div class="item-detail gear-notes">{{data.notes}}</div>
                                    <div class="item-controls-wide">
                                        {{#if (eq cid "on-person")}}
                                            {{#unless (or (eq item.type "containergear") (eq item.type "miscgear"))}}
                                                <a class="item-control item-equip" title="Equip"><i
                                                        class="{{#if data.isEquipped}}active{{/if}} fas fa-shield-alt"></i></a>
                                            {{/unless}}
                                            <a class="item-control item-carry" title="Carry"><i
                                                    class="{{#if data.isCarried}}active{{/if}} fas fa-suitcase"></i></a>
                                        {{/if}}
                                        <a class="item-control item-edit" title="Edit"><i
                                                class="active fas fa-edit"></i></a>
                                        <a class="item-control item-delete" title="Delete"
                                            data-label="Miscellaneous Gear"><i class="active fas fa-trash"></i></a>
                                    </div>
                                </li>
                            {{/if}}
                        {{/each}}
                    </ol>
                </ol>
            {{/each}}
        </div>

        {{!-- Macro Tab --}}
        <div class="tab macro" data-group="primary" data-tab="macro">
            <div class="form-group">
                <label>Type</label>
                <select name="data.macros.type">
                    {{#select data.macros.type}}
                    {{#each macroTypes}}
                    <option value="{{this}}">{{this}}</option>
                    {{/each}}
                    {{/select}}
                </select>
            </div>
        
            <div class="form-group stacked command">
                <label>Command</label>
                <textarea name="data.macros.command">{{data.macros.command}}</textarea>
            </div>
        </div>

        {{!-- Effects Tab --}}
        <div class="tab effects" data-group="primary" data-tab="effects">
            <ol class="effects-list">
                <li class="effects-header flexrow">
                    <h3 class="effect-name flexrow">Effect<a class="more-info"
                        data-journal-entry="Sheet - Effect Tab"><i
                            class="far fa-question-circle"></i></a></h3>
                    <div class="effect-source">Source</div>
                    <div class="effect-duration">Remaining</div>
                    <div class="effect-changes">Changes</div>
                    <a class="effect-controls effect-control" title="Add Effect" data-action="create"><span class="active"><i
                        class="fas fa-plus"></i> Add</span></a>
                </li>
                <ol class="effect-list item-list">
                {{#each effects as |effect id|}}
                    <li class="effect {{#if effect.data.disabled}}disabled{{/if}} flexrow" data-effect-id="{{effect.data._id}}">
                        <div class="effect-name flexrow">
                            <div class="effect-image" style="background-image: url('{{effect.data.icon}}')"></div>
                            <h4>{{effect.data.label}}</h4>
                        </div>
                        <div class="effect-ele effect-source">{{effect.source}}</div>
                        <div class="effect-ele effect-duration">{{effect.duration.label}}</div>
                        <div class="effect-ele effect-changes">{{effect.changes}}</div>
                        <div class="effect-controls">
                            <a class="effect-control" data-action="toggle"><i class="{{#unless effect.data.disabled}}active{{/unless}} fas fa-circle-notch"></i></a>
                            <a class="effect-control" data-action="edit"><i class="active fas fa-edit"></i></a>
                            <a class="effect-control" data-action="delete"><i class="active fas fa-trash"></i></a>
                        </div>
                    </li>
                {{/each}}
                </ol>
            </ol>
        </div>
    </section>

</form>
